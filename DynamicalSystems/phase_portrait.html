
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>The phase portrait &#8212; Mathematics for Natural Sciences A</title>
    
  <link href="../_static/css/theme.css" rel="stylesheet">
  <link href="../_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/sphinx-book-theme.d59cb220de22ca1c485ebbdc042f0030.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]], "processRefs": false, "processEnvironments": false}})</script>
    <script async="async" src="https://unpkg.com/thebe@0.5.1/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../_static/logo.jpg" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Mathematics for Natural Sciences A</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../intro.html">
   Welcome to Mathematics for Natural Sciences A
  </a>
 </li>
</ul>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../Prelim/notationfunctions.html">
   1. Mathematical Prelimaries
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../complex_numbers/complex_numbers.html">
   2. Complex Numbers
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../sequences_and_series/series.html">
   3. Sequences and Series
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        <a class="dropdown-buttons"
            href="../_sources/DynamicalSystems/phase_portrait.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download notebook file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/DynamicalSystems/phase_portrait.md"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.md</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
                onclick="printPdf(this)" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/executablebooks/jupyter-book"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/executablebooks/jupyter-book/issues/new?title=Issue%20on%20page%20%2FDynamicalSystems/phase_portrait.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/executablebooks/jupyter-book/master?urlpath=tree/docs/DynamicalSystems/phase_portrait.md"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show noprint">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#a-motivating-example-in-1d">
   A motivating example in 1D
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#a-motivating-example-in-2d">
   A motivating example in 2D
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#solving-numerically">
     Solving numerically
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#time-series-plots">
     Time series plots
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#state-space-plots">
     State space plots
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id1">
     The phase portrait
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#the-vector-field">
     The vector field
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#classifying-different-behaviours">
     Classifying different behaviours
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#exercise">
   Exercise
  </a>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>The phase portrait</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#a-motivating-example-in-1d">
   A motivating example in 1D
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#a-motivating-example-in-2d">
   A motivating example in 2D
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#solving-numerically">
     Solving numerically
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#time-series-plots">
     Time series plots
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#state-space-plots">
     State space plots
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id1">
     The phase portrait
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#the-vector-field">
     The vector field
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#classifying-different-behaviours">
     Classifying different behaviours
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#exercise">
   Exercise
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            
              <div>
                
  <div class="section" id="the-phase-portrait">
<h1>The phase portrait<a class="headerlink" href="#the-phase-portrait" title="Permalink to this headline">¶</a></h1>
<p>In this section, we introduce the phase portrait representation of an autonomous ODE. This is a plot of the solution <em>state space</em>, illustrating any equilibrium points and selected trajectories. We usually do not need to solve the ODE to obtain the phase portrait.</p>
<p>We train ourselves to understand the behaviour from looking at the phase plane, because we can often construct the phase plane even when there is no exact solution.</p>
<div class="section" id="a-motivating-example-in-1d">
<span id="motv-exam"></span><h2>A motivating example in 1D<a class="headerlink" href="#a-motivating-example-in-1d" title="Permalink to this headline">¶</a></h2>
<p>Consider the following ODE, subject to the given initial condition :</p>
<p>\begin{equation}
\dot{x}=2x, \qquad x(0)=x_0.
\end{equation}</p>
<p>We can solve this problem by separation of variables to obtain a family of solution curves, each corresponding to different values of the initial condition:</p>
<p>\begin{equation}
x = x_0 e^{2t}.
\end{equation}</p>
<p>Notice that for this example,</p>
<ul class="simple">
<li><p>if <span class="math notranslate nohighlight">\(x_0 &gt;0\)</span> then <span class="math notranslate nohighlight">\(x\)</span> is always strictly increasing (monotonic increasing)</p></li>
<li><p>if <span class="math notranslate nohighlight">\(x_0 &lt;0\)</span> then <span class="math notranslate nohighlight">\(x\)</span> is always strictly decreasing (monotonic decrasing)</p></li>
<li><p>if <span class="math notranslate nohighlight">\(x_0=0\)</span> then the <span class="math notranslate nohighlight">\(x=0\)</span> <span class="math notranslate nohighlight">\(\forall t\)</span>. This is an equilibrium point.</p></li>
</ul>
<div class="theorem admonition">
<p class="admonition-title">Equilibrium point (1D)</p>
<p>For a system described by <span class="math notranslate nohighlight">\(\dot{x}=f(x)\)</span>, a point where <span class="math notranslate nohighlight">\(f(x)=0\)</span> is called an <strong>equilibrium point</strong>.</p>
<p>If an equilibrium point is given as the initial condition then the system will remain there for all time. We are usually interested to know how the system behaves when it is near to equilibrium.</p>
</div>
<p><strong>Below-left diagram:</strong></p>
<p>We could infer the behaviour from the ODE without solving it by looking at a graph of <span class="math notranslate nohighlight">\((x,\dot{x})\)</span>. To the right of the equilibrium, <span class="math notranslate nohighlight">\(\dot{x}\)</span> is positive and therefore <span class="math notranslate nohighlight">\(x\)</span> is increasing. To the left of the equilibrium <span class="math notranslate nohighlight">\(\dot{x}\)</span> is negative and therefore <span class="math notranslate nohighlight">\(x\)</span> is decreasing.</p>
<p><strong>Below-right diagram:</strong></p>
<p>For this system the real number line represents the <strong>state space</strong> of possible values that the solution <span class="math notranslate nohighlight">\(x(t)\)</span> can take. The direction of change at each point in state space is shown using arrows.</p>
<p>On <span class="math notranslate nohighlight">\(x&gt;0\)</span> the change vector points in the direction of increasing <span class="math notranslate nohighlight">\(x\)</span>, and on <span class="math notranslate nohighlight">\(x&lt;0\)</span> the change vector points in the direction of decreasing <span class="math notranslate nohighlight">\(x\)</span>. The change vector only swaps sign (direction) at the equilibrium point.</p>
<br><div class="cell_output docutils container">
<img alt="../_images/phase_portrait_1_0.png" src="../_images/phase_portrait_1_0.png" />
</div>
<br>
<p>The state space diagram provides a qualitative view of the ordinary differential equation, from only a one-dimensional image. We can infer from the state space diagram that the point <span class="math notranslate nohighlight">\(x=0\)</span> is an equilibrium point, and moreover that it is <strong>unstable</strong>. If we provide an initial condition near to the equilibrium point, the system will move away from the equilibrium.</p>
<p>The diagram also provides information about how the system will behave for all possible initial conditions.</p>
<div class="toggle docutils container">
<p><strong>Solution:</strong>
Here the graphs of <span class="math notranslate nohighlight">\((x,\dot{x})\)</span> and the state space have been shown on the same diagram for ease of presentation.</p>
<ul class="simple">
<li><p>The equilibrium point at <span class="math notranslate nohighlight">\(x=0\)</span> is stable</p></li>
<li><p>The equilibrium point at <span class="math notranslate nohighlight">\(x=a\)</span> is unstable</p></li>
<li><p>The equilibrium point at <span class="math notranslate nohighlight">\(x=k\)</span> is stable</p></li>
</ul>
<div class="cell_output docutils container">
<img alt="../_images/phase_portrait_3_0.png" src="../_images/phase_portrait_3_0.png" />
</div>
</div>
</div>
<div class="section" id="a-motivating-example-in-2d">
<span id="undamp-pend"></span><h2>A motivating example in 2D<a class="headerlink" href="#a-motivating-example-in-2d" title="Permalink to this headline">¶</a></h2>
<p>We now consider the equation of motion for a simple pendulum, which is given by the following nonlinear second order ODE. The term with coefficient <span class="math notranslate nohighlight">\(k\)</span> represents frictional effects, and the term with coefficient <span class="math notranslate nohighlight">\(\omega^2\)</span> represents the weight of the pendulum.</p>
<p>\begin{equation}
\ddot{x}+k\dot{x}+\omega^2\sin(x)=0
\end{equation}</p>
<p>We may rewrite the equation as a coupled first order system by introducing the variable <span class="math notranslate nohighlight">\(y=\dot{x}\)</span>, which gives</p>
<p>\begin{equation}
\begin{bmatrix}\dot{x}\dot{y}\end{bmatrix} = \begin{bmatrix}y-\omega^2\sin(x)-ky\end{bmatrix}
\end{equation}</p>
<p>The system has equilibrium points when <span class="math notranslate nohighlight">\(\dot{x}=\dot{y}=0\)</span>. These occur at</p>
<p>\begin{equation}
x=n\pi, \quad y=0, \qquad n\in\mathbb{Z}.
\end{equation}</p>
<div class="theorem admonition">
<p class="admonition-title">Equilibrium point (2D)</p>
<p>Equilibrium points for a system described by
\begin{align*}
\dot{x}&amp;=f(x,y)\
\dot{y}&amp;=g(x,y)
\end{align*}</p>
<p>must satisfy <span class="math notranslate nohighlight">\(f(x,y)=g(x,y)=0\)</span>.</p>
</div>
<p>As in the previous example, we would like to investigate the behaviour of the system at points near to the equilibrium solutions. Although we could make progress investigating this system by hand, we will here illustrate the dynamics using computer plots for convenience.</p>
<br>
<p><strong>Python definition:</strong></p>
<p>We can set up the system in Python as follows. Our defined function <code class="docutils literal notranslate"><span class="pre">pend</span></code> takes an input state <code class="docutils literal notranslate"><span class="pre">X</span></code> and returns the derivatives. Our definition requires that the parameter values <code class="docutils literal notranslate"><span class="pre">w</span></code> and <code class="docutils literal notranslate"><span class="pre">k</span></code> are provided as inputs.</p>
<p>The independent variable <code class="docutils literal notranslate"><span class="pre">t</span></code> must also be given as an input, even though it does not appear explicitly in the equations. This is because the method we will use to solve the system expects a definition of the form <code class="docutils literal notranslate"><span class="pre">f(X,t,params)</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Model definition</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="k">def</span> <span class="nf">pend</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">t</span><span class="p">,</span><span class="n">w</span><span class="p">,</span><span class="n">k</span><span class="p">):</span>
  <span class="n">dxdt</span> <span class="o">=</span> <span class="n">X</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
  <span class="n">dydt</span> <span class="o">=</span> <span class="o">-</span><span class="n">w</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">-</span><span class="n">k</span><span class="o">*</span><span class="n">X</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
  <span class="k">return</span> <span class="p">[</span><span class="n">dxdt</span><span class="p">,</span> <span class="n">dydt</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<br>
<div class="section" id="solving-numerically">
<h3>Solving numerically<a class="headerlink" href="#solving-numerically" title="Permalink to this headline">¶</a></h3>
<p>We can solve the system to obtain the angular displacement <span class="math notranslate nohighlight">\(x(t)\)</span> and the velocity <span class="math notranslate nohighlight">\(y(t)\)</span> for given parameters and initial conditions.</p>
<p>In the work that follows we will choose <span class="math notranslate nohighlight">\(k=0\)</span>, which means there are no losses due to friction. We will take <span class="math notranslate nohighlight">\(\omega=1\)</span> and we will begin by choosing initial conditions <span class="math notranslate nohighlight">\(x(0)=1\)</span>, <span class="math notranslate nohighlight">\(y(0)=0\)</span>.</p>
<p>The solution uses the <code class="docutils literal notranslate"><span class="pre">odeint</span></code> function which is a numerical ODE solver. We specify the timepoints <code class="docutils literal notranslate"><span class="pre">t</span></code> that we require the solution value for. The solver returns <code class="docutils literal notranslate"><span class="pre">X</span></code> which is the numeric solution at those timepoints. Each column in <code class="docutils literal notranslate"><span class="pre">X</span></code> gives the solution values for one of the dependent variables, so for this system there will be two columns.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.integrate</span> <span class="kn">import</span> <span class="n">odeint</span>

<span class="c1"># Parameter values</span>
<span class="n">w</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span> <span class="n">k</span><span class="o">=</span><span class="mi">0</span>

<span class="c1"># Initial conditions for t,x,y</span>
<span class="n">t0</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">X0</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span>

<span class="c1"># time points from t0 to tmax (1000 points)</span>
<span class="n">tmax</span><span class="o">=</span><span class="mi">20</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">t0</span><span class="p">,</span><span class="n">tmax</span><span class="p">,</span><span class="mi">1000</span><span class="p">)</span>    

<span class="c1"># solve ODE</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">odeint</span><span class="p">(</span><span class="n">pend</span><span class="p">,</span><span class="n">X0</span><span class="p">,</span><span class="n">t</span><span class="p">,</span><span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">w</span><span class="p">,</span><span class="n">k</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<br>
</div>
<div class="section" id="time-series-plots">
<h3>Time series plots<a class="headerlink" href="#time-series-plots" title="Permalink to this headline">¶</a></h3>
<p>We can plot the time series for the given parameters and conditions, as shown below. Most of the code here is just twiddles to improve how the plot looks, such as changes to the axis limits or plot labels. The main functional part of the code is the following line that plots the timepoints <code class="docutils literal notranslate"><span class="pre">t</span></code> against the solutions for <span class="math notranslate nohighlight">\(x\)</span>, which are found in the first column of array <code class="docutils literal notranslate"><span class="pre">X</span></code>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">X</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="c1"># plot results</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">X</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;time&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">([</span><span class="n">t0</span><span class="p">,</span><span class="n">tmax</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/phase_portrait_9_0.png" class="align-center" src="../_images/phase_portrait_9_0.png" />
</div>
</div>
<br>
<p>If we want to understand how the system behaves for a range of initial conditions or when subjected to a small perturbation, we would need to re-solve and compare multiple solutions. This is inconvenient.</p>
<br>
</div>
<div class="section" id="state-space-plots">
<h3>State space plots<a class="headerlink" href="#state-space-plots" title="Permalink to this headline">¶</a></h3>
<p>We can make better progress by working in state space. This time, there are two state variables, <span class="math notranslate nohighlight">\(x\)</span> and <span class="math notranslate nohighlight">\(y\)</span> and so the state space is <span class="math notranslate nohighlight">\(\mathbb{R}^2\)</span>. This makes sense, because to solve a second order ODE we need to have two initial conditions. In this case we have one condition for the initial angular displacement <span class="math notranslate nohighlight">\(x(0)\)</span> and one condition for the initial angular velocity <span class="math notranslate nohighlight">\(y(0)\)</span>.</p>
<p>The plot below shows the solution trajectory in state space corresponding to the parameter values and initial conditions that we used in the time series plot above.</p>
<p>The main functional part of the code is the following line that plots <span class="math notranslate nohighlight">\(x\)</span> against <span class="math notranslate nohighlight">\(y\)</span> by extracting each column from array <code class="docutils literal notranslate"><span class="pre">X</span></code>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span><span class="n">X</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>The arrows shown on this plot illustrate the direction of change. The code that was used to add the arrows to the trajectory has not been provided, because you won’t need this for your work.</p>
<div class="toggle docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span><span class="n">X</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">([</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">],[</span><span class="s1">&#39;$-\pi$&#39;</span><span class="p">,</span><span class="s1">&#39;0&#39;</span><span class="p">,</span><span class="s1">&#39;$\pi$&#39;</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<img alt="../_images/phase_portrait_11_0.png" class="align-center" src="../_images/phase_portrait_11_0.png" />
</div>
</div>
<br>
<p><strong>Observations</strong></p>
<p>It can be seen that time series oscillations correspond to circles or ellipses in state space. This is a general result, that you should learn to recognise.</p>
<p>The initial condition that was used here lies at the point <span class="math notranslate nohighlight">\((1,0)\)</span>. For these values <span class="math notranslate nohighlight">\(\dot{y}&lt;0\)</span> and <span class="math notranslate nohighlight">\(\dot{x}=0\)</span> so the change vector points vertically downwards at that point as shown. For increasing time the solution evolves clockwise along the trajectory.</p>
<div class="admonition-think-about-it admonition">
<p class="admonition-title">Think about it!</p>
<p>Try tracing your finger around the circle and consider (separately) how variables <span class="math notranslate nohighlight">\(x\)</span> and <span class="math notranslate nohighlight">\(y\)</span> change. Where is <span class="math notranslate nohighlight">\(x\)</span> increasing and where is it decreasing? Which positions on the trajectory correspond to the lowest and highest parts of the pendulum swing? Where is the speed zero?</p>
</div>
<br>
</div>
<div class="section" id="id1">
<h3>The phase portrait<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h3>
<p>The plot below illustrates several solution trajectories for the undamped pendulum on the same sketch. The equilibrium points are also marked. Notice the difference in character between solution trajectories near to <span class="math notranslate nohighlight">\(x=0\)</span> compared to those near <span class="math notranslate nohighlight">\(x=\pm\pi\)</span>. The former corresponds to the pendulum in the downward vertical position, whilst the latter corresponds to the pendulum in the upward vertical position.</p>
<p>Initialising the pendulum with a low/moderate speed provides backward and forward oscillations of constant amplitude (closed trajectories). However, for larger value of the initial speed the pendulum performs complete revolutions (open trajectories). The <em>separatrix</em> is the curve that separates the open and closed trajectories. It is identified on the sketch in dashed blue.</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<img alt="../_images/phase_portrait_13_0.png" class="align-center" src="../_images/phase_portrait_13_0.png" />
</div>
</div>
<p>We can classify the equilibrium points as follows:</p>
<p><strong>Stationary point at <span class="math notranslate nohighlight">\((0,0)\)</span></strong></p>
<p>This point corresponds to the pendulum in a stationary downward vertical position. We can see from the diagram that the point is encircled by closed orbits, which represents periodic motion. If we intialise the pendulum in a state close the equilibrium it will oscillate, following a repeating circular trajectory forever. This type of equilibrium point is called a “centre”.</p>
<p><strong>Stationary point at <span class="math notranslate nohighlight">\((\pm\pi,0)\)</span></strong></p>
<p>This point corresponds to the pendulum in a stationary upward vertical position. If the pendulum is started at the equilibrium point it will remain there, but if it is started from a perturbed position close to the upward vertical, it will move away. As there is no damping, the subsequent motion depends on whether the pendulum is released from rest or given a push. If it is released from rest close to the upward vertical it will perform closed oscillations. If it is given a push it may perform repeated full rotations. This type of equilibrium point is called a “saddle”.</p>
<div class="theorem admonition">
<p class="admonition-title">Terminology</p>
<p>A plot showing a region of state space together with any equilibrium points and some indicative trajectories is called a phase portrait.</p>
<p>The phase portrait is useful because it shows us how the system behaves for a range of initial conditions.</p>
<p>Usually we also mark some of the change vectors on a phase portrait to provide further information, as discussed below.</p>
</div>
</div>
<div class="section" id="the-vector-field">
<h3>The vector field<a class="headerlink" href="#the-vector-field" title="Permalink to this headline">¶</a></h3>
<p>We can also infer solution trajectories by plotting the vector field <span class="math notranslate nohighlight">\((\dot{x},\dot{y})\)</span> in state space. Since there is no explicit time dependence on the right-hand side, the change vectors remain static and the solution will follow a trajectory tangent to them.</p>
<p>In Python we can use the <code class="docutils literal notranslate"><span class="pre">quiver</span></code> function to plot the vector field, as shown below-left. It can be difficult to infer the behaviour from the vector field alone, but by combining plots of the vector field with a few solution trajectories we can usually get a good overview.</p>
<p>Replacing the <code class="docutils literal notranslate"><span class="pre">quiver</span></code> function with the <code class="docutils literal notranslate"><span class="pre">streamplot</span></code> function results in an attempt by Python to create the curves that are tangent to the vector field, as shown below-right.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Define x and y value ranges</span>
<span class="n">xmin</span><span class="o">=-</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">;</span> <span class="n">xmax</span><span class="o">=</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">;</span>
<span class="n">ymin</span><span class="o">=-</span><span class="mf">2.5</span><span class="p">;</span> <span class="n">ymax</span><span class="o">=</span><span class="mf">2.5</span><span class="p">;</span>

<span class="c1"># We will use 30 grid points in each direction</span>
<span class="n">npts</span><span class="o">=</span><span class="mi">30</span>
<span class="n">x</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">xmin</span><span class="p">,</span><span class="n">xmax</span><span class="p">,</span><span class="n">npts</span><span class="p">)</span>
<span class="n">y</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">ymin</span><span class="p">,</span><span class="n">ymax</span><span class="p">,</span><span class="n">npts</span><span class="p">)</span>
<span class="p">[</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">]</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>

<span class="c1"># Define the vector field values at each point</span>
<span class="p">(</span><span class="n">U</span><span class="p">,</span><span class="n">V</span><span class="p">)</span><span class="o">=</span><span class="p">(</span><span class="n">Y</span><span class="p">,</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">X</span><span class="p">))</span>

<span class="c1"># Make and twiddle the plot</span>
<span class="n">fig</span><span class="p">,</span><span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">quiver</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">,</span><span class="n">U</span><span class="p">,</span><span class="n">V</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">streamplot</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">,</span><span class="n">U</span><span class="p">,</span><span class="n">V</span><span class="p">,</span><span class="n">arrowsize</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/phase_portrait_15_0.png" src="../_images/phase_portrait_15_0.png" />
</div>
</div>
<p>The quality of the streamplots is usually not very satisfactory unless additional painstaking work is undertaken to force a better result. An example of a better result is shown below.</p>
<p>However, by combining  rough-and-ready streamplots with mathematical analysis we can usually get a very clear understanding of the system dynamics.</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>

<span class="c1"># Define trajectory start points</span>
<span class="n">start</span><span class="o">=</span><span class="p">[</span>
       <span class="p">[</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span><span class="mf">0.01</span><span class="p">],[</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span><span class="o">-</span><span class="mf">0.01</span><span class="p">],[</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span><span class="mf">2.4</span><span class="p">],[</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span><span class="o">-</span><span class="mf">2.4</span><span class="p">],</span>
       <span class="p">[</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">],[</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mf">0.4</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mf">0.8</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mf">1.2</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mf">1.6</span><span class="p">],</span>
       <span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span><span class="mf">0.4</span><span class="p">],[</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span><span class="mf">0.8</span><span class="p">],[</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span><span class="mf">1.2</span><span class="p">],[</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span><span class="mf">1.6</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span><span class="mf">0.4</span><span class="p">],[</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span><span class="mf">0.8</span><span class="p">],[</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span><span class="mf">1.2</span><span class="p">],[</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span><span class="mf">1.6</span><span class="p">]</span>
       <span class="p">]</span>

<span class="n">plt</span><span class="o">.</span><span class="n">streamplot</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">,</span><span class="n">U</span><span class="p">,</span><span class="n">V</span><span class="p">,</span><span class="n">start_points</span><span class="o">=</span><span class="n">start</span><span class="p">,</span><span class="n">density</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span><span class="n">arrowsize</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/phase_portrait_17_0.png" class="align-center" src="../_images/phase_portrait_17_0.png" />
</div>
</div>
<div class="admonition-side-note-on-phase-paths admonition">
<p class="admonition-title">Side note on phase paths</p>
<p>Whilst is not generally practical to find an explicit expression <span class="math notranslate nohighlight">\(y(x)\)</span> for the phase paths, we can sometimes do it. In the case of this undamped pendulum the phase paths satisfy</p>
<p>\begin{equation*}
\frac{\mathrm{d}y}{\mathrm{d}x}=\frac{\dot{y}}{\dot{x}}=-\frac{\omega^2\sin(x)}{y}.
\end{equation*}</p>
<p>Solving by separation gives the following result where <span class="math notranslate nohighlight">\(k\)</span> is an arbitrary constant</p>
<div class="math notranslate nohighlight">
\[y=\pm \sqrt{2}\omega \sqrt{k+\cos(x)}.\]</div>
<p>For <span class="math notranslate nohighlight">\(k&gt;1\)</span> we have open orbits, and for <span class="math notranslate nohighlight">\(-1&lt;k&lt;1\)</span> we have closed orbits (periodic motion). The case <span class="math notranslate nohighlight">\(k=1\)</span> gives the separatrix, which divides between qualitatively different behaviours.</p>
</div>
</div>
<div class="section" id="classifying-different-behaviours">
<h3>Classifying different behaviours<a class="headerlink" href="#classifying-different-behaviours" title="Permalink to this headline">¶</a></h3>
<p>In the each of the time series and state space plots above we considered the undamped case <span class="math notranslate nohighlight">\(k=0\)</span>. Now we will repeat our methodology for the case where there is a small amount of damping <span class="math notranslate nohighlight">\(k=0.4\)</span>. The following code produces a rough-and-ready version of the phase portrait shown below.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">k</span><span class="o">=</span><span class="mf">0.4</span>
<span class="p">(</span><span class="n">U</span><span class="p">,</span><span class="n">V</span><span class="p">)</span><span class="o">=</span><span class="p">(</span><span class="n">Y</span><span class="p">,</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">X</span><span class="p">)</span><span class="o">-</span><span class="n">k</span><span class="o">*</span><span class="n">Y</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">streamplot</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">,</span><span class="n">U</span><span class="p">,</span><span class="n">V</span><span class="p">,</span><span class="n">arrowsize</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<img alt="../_images/phase_portrait_19_0.png" class="align-center" src="../_images/phase_portrait_19_0.png" />
</div>
</div>
<p>The addition of damping does not change the locations of the equilibria, but it dos affect their stability. All solutions decay gradually towards the equilibrium at <span class="math notranslate nohighlight">\((0,0)\)</span>. This is represented by an inward-spiralling trajectory on the phase diagram. The pendulum oscillates with decaying amplitude.</p>
</div>
</div>
<div class="section" id="exercise">
<h2>Exercise<a class="headerlink" href="#exercise" title="Permalink to this headline">¶</a></h2>
<div class="toggle docutils container">
<p><strong>Solution:</strong></p>
<p>There is a stationary point at</p>
<p>\begin{equation*}(p,s)=\left(\frac{v_0}{k},\frac{k^2}{c v_0}\right)\end{equation*}</p>
<p>It is a little easier to see the behaviour clearly by plotting trajectories rather than streamlines.</p>
<ul class="simple">
<li><p>For <span class="math notranslate nohighlight">\(c=1.1\)</span> the equilibrium point is a stable centre. The red trajectory spirals in towards the equilibrium point.</p></li>
<li><p>For <span class="math notranslate nohighlight">\(c=0.9\)</span> the equilibrium point is unstable. The blue trajectory spirals out away from the equilibrium point.</p></li>
</ul>
<p>For <span class="math notranslate nohighlight">\(c=0.9\)</span> we see that the solution approaches a closed cycle from initial conditions inside (blue) and outside (red). This is called a <em>limit cycle</em>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># define the model</span>
<span class="k">def</span> <span class="nf">glyco</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">t</span><span class="p">,</span><span class="n">v0</span><span class="p">,</span><span class="n">c</span><span class="p">,</span><span class="n">k</span><span class="p">):</span>
  <span class="n">dpdt</span> <span class="o">=</span> <span class="n">c</span><span class="o">*</span><span class="n">X</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">X</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">k</span><span class="o">*</span><span class="n">X</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
  <span class="n">dsdt</span> <span class="o">=</span> <span class="n">v0</span> <span class="o">-</span> <span class="n">c</span><span class="o">*</span><span class="n">X</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">X</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span>
  <span class="k">return</span> <span class="p">[</span><span class="n">dpdt</span><span class="p">,</span><span class="n">dsdt</span><span class="p">]</span>

<span class="c1"># define the time range and fixed parameters</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">100</span><span class="p">,</span><span class="mi">10000</span><span class="p">)</span>
<span class="n">v0</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span> <span class="n">k</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span>

<span class="c1"># make plot axes</span>
<span class="n">fig</span><span class="p">,</span><span class="n">ax</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>

<span class="c1"># Solve for c=1.1</span>
<span class="n">X0</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">odeint</span><span class="p">(</span><span class="n">glyco</span><span class="p">,</span><span class="n">X0</span><span class="p">,</span><span class="n">t</span><span class="p">,</span><span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">v0</span><span class="p">,</span><span class="mf">1.1</span><span class="p">,</span><span class="n">k</span><span class="p">))</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span><span class="n">X</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;c=1.1&#39;</span><span class="p">)</span>

<span class="c1"># Solve for c=0.9 (red trajectory)</span>
<span class="n">X0</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">odeint</span><span class="p">(</span><span class="n">glyco</span><span class="p">,</span><span class="n">X0</span><span class="p">,</span><span class="n">t</span><span class="p">,</span><span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">v0</span><span class="p">,</span><span class="mf">0.9</span><span class="p">,</span><span class="n">k</span><span class="p">))</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span><span class="n">X</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>

<span class="c1"># Solve for c=0.9 (blue trajectory)</span>
<span class="n">X0</span><span class="o">=</span><span class="p">[</span><span class="mf">1.01</span><span class="p">,</span><span class="mf">1.12</span><span class="p">]</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">odeint</span><span class="p">(</span><span class="n">glyco</span><span class="p">,</span><span class="n">X0</span><span class="p">,</span><span class="n">t</span><span class="p">,</span><span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">v0</span><span class="p">,</span><span class="mf">0.9</span><span class="p">,</span><span class="n">k</span><span class="p">))</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span><span class="n">X</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;c=0.9&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/phase_portrait_21_0.png" src="../_images/phase_portrait_21_0.png" />
</div>
<p>We see that the nature of the equilibrium point depends on parameter <span class="math notranslate nohighlight">\(c\)</span>, when the other parameters are kept fixed. We will see in a later chapter that the qualitative behaviour of systems can be highly sensitive to small changes in parameter values.</p>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./DynamicalSystems"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            
                <!-- Previous / next buttons -->
<div class='prev-next-area'>
</div>
            
        </div>
    </div>
    <footer class="footer">
  <p>
    
      By Natural Sciences<br/>
    
        &copy; Copyright 2021.<br/>
  </p>
</footer>
</main>


      </div>
    </div>
  
  <script src="../_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  </body>
</html>